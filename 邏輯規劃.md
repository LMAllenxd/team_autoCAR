# 自走車邏輯規劃 (Planning)

## 一、專案目標
- 結合紅外線循跡與超音波避障，並且找到對的參數，實現自走車的執行、轉彎與避障功能。

## 二、系統結構

### 1. 感測器
- 紅外線感測器 (IR_left、IR_right)：偵測黑色路線。
- 超音波感測器 (TRIG、ECHO)：測量前方障礙物距離。

### 2. 馬達與驅動
- L298N 驅動板控制四顆直流馬達（左右各兩顆輪子）。
- LED 指示燈 (LED_LEFT、LED_RIGHT) 顯示前進、左轉彎與右轉彎。

## 三、功能模組與邏輯流程

### 1. 循跡 (Execution)
- 讀取 `IR_left`、`IR_right` 數值：LOW 表示感測到黑線，HIGH 表示離線。
- 決策流程：
  - 兩感測器都 LOW → `forward()` 前進。
  - 左 HIGH 右 LOW → `turnRight()` 右轉修正。
  - 左 LOW 右 HIGH → `turnLeft()` 左轉修正。
  - 兩感測器都 HIGH → `stopMotors()` 停止，並延遲等待。

### 2. 轉彎 (Turning)
- `turnLeft()`：左輪停止、右輪反轉，亮起左側 LED。
- `turnRight()`：右輪停止、左輪反轉，亮起右側 LED。

### 3. 避障 (Obstacle Avoidance)
- 讀取 `readUltrasonic()` 得到前方距離 (cm)。
- 若距離小於閾值 (預設 20cm)：
  1. `stopMotors()` 停車。
  2. 延遲短暫停頓。
  3. `backward()` 後退一定時間。
  4. `stopMotors()` 停車。
  5. `turnLeft()` 或 `turnRight()` 選擇轉向偵測後方路徑。
  6. 停車並延遲，回到循跡主流程。

### 4. 後退 (Reversing)
- `backward()`：兩輪同時反向轉動，LED 熄滅。

## 四、實作步驟
1. **硬體佈線**：按照腳位定義接線 IR、超音波、馬達、LED。
2. **超音波讀距函式**：撰寫 `readUltrasonic()`，回傳距離值。
3. **後退函式**：新增 `backward()`，控制馬達反轉。
4. **整合避障邏輯**：在 `loop()` 前端增加超音波距離偵測與避障流程。
5. **測試與調整**：逐步上傳、調試參數 (PWM、延遲時間、閾值)。
6. **優化**：視實際路況微調速度與轉向策略。
